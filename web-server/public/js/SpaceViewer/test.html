<!DOCTYPE HTML>
<html>
<head>
    <script>
        var require = {
            paths: {
                'domReady': '../../components/requirejs-domready/domReady',
                'three': '../../components/three.js/three',
                'mtlloader': '../ThreeJsAddons/MTLLoader',
                'objloader': '../ThreeJsAddons/OBJLoader',
                'objmtlloader': '../ThreeJsAddons/OBJMTLLoader',
                'threexspaceships': '../../components/threex.spaceships/threex.spaceships',
                'jquery': '../../components/jquery/dist/jquery',
                'lodash': '../../components/lodash/dist/lodash',
                'SpaceObjectsRenderer': '../lib/SpaceObjectsRenderer'
            },
            shim: {
                'three': {
                    exports: 'THREE'
                },
                'mtlloader': ['three'],
                'objloader': ['three'],
                'objmtlloader': ['three'],
                'threexspaceships': {
                    deps: ['three', 'mtlloader', 'objloader', 'objmtlloader'],
                    exports: 'THREEx',
                    init: function() {
                        this.THREEx.SpaceShips.baseUrl = '/components/threex.spaceships/';
                    }
                }
            }
        };
    </script>
    <style type="text/css">
        html, body {
            min-height: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
<div id="canvas" style="width: 100%; height: 100%;"></div>
<script src="../../components/requirejs/require.js"></script>
<script>

    require(['./viewer', 'jquery', 'lodash', 'domReady!'], function(SpaceViewer, $, _) {

        var spaceViewer = new SpaceViewer();

        var container = $('#canvas');

        container.append(spaceViewer.getDomElement());
        spaceViewer.setSize(container.width(), container.height());

        var ship = {
            orientation: [
                [1, 0, 0],
                [0, 1, 0],
                [0, 0, 1]
            ],
            position: {
                x: 0,
                y: 0,
                z: 0
            }
        };

        var objects = [
            {
                id: 1,
                position: {
                    x: 0,
                    y: 0,
                    z: 6
                }
            }
        ];

        spaceViewer.updateShip(ship);
        spaceViewer.updateObjects(objects);

        spaceViewer.animate();

        function moveObjects() {
            _.forIn(objects, function(object, index) {
                objects[index].position.z += 0.002;
            });
            spaceViewer.updateObjects(objects);
        }
        window.setInterval(moveObjects, 100);

        window.onresize = function() {
            spaceViewer.setSize(container.width(), container.height());
        };

    });

</script>
</body>
</html>
